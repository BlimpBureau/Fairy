/*	Scripts for the tables test page 
		Original author: Maggie Wachs, www.filamentgroup.com
		Author of extended script: Nadan Gergeo
		Date: November 2011
		Dependencies: jQuery, jQuery UI widget factory
*/function updateStickyTableHead(e,t){e=$(e);var n=e.find("thead"),r=e.offset().top,i=$(window).scrollTop(),s=e.height()-t.height(),o,u=!1;if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))u=!0;o=i-r;o-=1;o<0?o=0:o>s&&(o=s);if(i>r&&i<r+e.height())if(!u)t.css({visibility:"visible",top:o+"px"});else{t.css({visibility:"visible"});t.animate({top:o+"px"},400);n.css({visibility:"hidden"})}else u?t.animate({top:"0"},400,function(){n.css({visibility:"visible"});t.css({visibility:"hidden"})}):t.css({visibility:"hidden"})}$(document).on("click.dropdown.data-api",".dropdown-menu .checkbox-row",function(e){e.stopPropagation()});(function(e){e.widget("filament.table",{options:{idprefix:"col-",checkContainer:null},_create:function(){function E(){u.removeClass("unfocused");u.removeClass("focused")}var t=this,n=t.options,r=t.element,i=r.find("thead"),s=r.find("tbody"),o=i.find("th"),u=s.find("tr"),a=n.checkContainer?e(n.checkContainer):e('<ul class="dropdown-menu"/>'),f="auto-on-"+r.attr("id");e(r).parent().hasClass("table-scroll-wrapper")===!1&&e(r).wrap('<div class="table-scroll-wrapper"/>');var l=e(r).parent(),c=l.parent(),h=e('<div class="btn-toolbar" />'),p=e('<div class="btn-group dropdown-btn-group pull-right" />'),d=e('<button class="btn btn-default dropdown-toggle" data-toggle="dropdown">Display <span class="caret"></span></button>'),v=e('<div class="btn-group mode-btn-group" />'),m=e('<button class="btn btn-default">Auto</button>'),g=e('<div class="btn-group focus-btn-group" />'),y=e('<button class="btn btn-default"><span class="glyphicon glyphicon-screenshot"></span> Focus</button>');r.hasClass("auto-on")&&m.addClass("btn-primary");g.append(y);v.append(m);p.append(d).append(a);h.append(g);h.append(v);h.append(p);c.prepend(h);o.each(function(t){var r=e(this),i=r.attr("id");if(!i){i=n.idprefix+t;r.attr("id",i)}if(r.is("[data-priority]")){var s=e('<li class="checkbox-row"><input type="checkbox" name="toggle-cols" id="toggle-col-'+t+'" value="'+i+'" /> <label for="toggle-col-'+t+'">'+r.text()+"</label></li>");a.append(s);s.click(function(){var e=s.find("input");e.prop("checked",!e.prop("checked"));e.trigger("change")});s.find("label").click(function(e){e.stopPropagation()});s.find("input").click(function(e){e.stopPropagation()}).change(function(){var t=e(this),n=t.val(),r=e(l).find("#"+n+", #"+n+"-clone, [data-columns~="+n+"]");r.each(function(){var n=e(this);if(t.is(":checked")){n.css("display")!=="none"&&n.prop("colSpan",parseInt(n.prop("colSpan"))+1);n.show()}else parseInt(n.prop("colSpan"))>1?n.prop("colSpan",parseInt(n.prop("colSpan"))-1):n.hide()})}).bind("updateCheck",function(){r.css("display")!=="none"?e(this).prop("checked",!0):e(this).prop("checked",!1)}).trigger("updateCheck")}});u.each(function(){var t=0;e(this).find("th, td").each(function(){var r=e(this),i="",s=r.prop("colSpan");s>1&&r.addClass("spn-cell");var o=0;for(var u=t;u<t+s;u++){i=i+" "+n.idprefix+u;var a=e(l).find("#"+n.idprefix+u),f=a.attr("class");f&&r.addClass(f);var c=a.attr("data-priority");c&&r.attr("data-priority",c);a.css("display")==="none"&&o++}r.prop("colSpan",Math.max(s-o,1));i=i.substring(1);r.attr("data-columns",i);t+=s})});e(window).bind("orientationchange resize "+f,function(){a.find("input").trigger("updateCheck");e(r).find(".spn-cell").each(function(){var t=e(this),n=t.attr("data-columns");n=n.split(" ");var r=n.length,i=0;for(var s=0;s<r;s++)e("#"+n[s]).css("display")==="none"&&i++;i!==r&&t.show();t.prop("colSpan",Math.max(r-i,1))})});a.children("li").length===0&&a.parent().hide();var b=e(r).clone();e(b).attr("id",r.attr("id")+"-clone");e(b).find("[id]").each(function(){e(this).attr("id",e(this).attr("id")+"-clone")});e(b).wrap('<div class="stickyTableHead"/>');var w=e(b).parent();e(w).css("height",i.height()+2);e(r).before(w);e(window).bind("scroll resize",function(){updateStickyTableHead(r,w)});m.click(function(){m.toggleClass("btn-primary");r.toggleClass("auto-on");b.toggleClass("auto-on");e(window).trigger(f)});y.click(function(){E();e(this).toggleClass("btn-primary");r.toggleClass("focus-on")});u.click(function(){if(r.hasClass("focus-on")){var t=e(this).hasClass("focused");E();if(!t){u.addClass("unfocused");e(this).addClass("focused")}}})},disable:function(){},enable:function(){}})})(jQuery);